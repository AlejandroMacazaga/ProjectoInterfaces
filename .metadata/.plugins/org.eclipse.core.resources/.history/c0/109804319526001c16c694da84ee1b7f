package dao;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;

import auxiliares.Deporte;
public class DeportesDAO {
		public ArrayList<Deporte> getAllDeportes() throws SQLException {
			ArrayList<Deporte> listDeportes = new ArrayList<Deporte>();
			ConexionDB conn = new ConexionDB();
			String sql = "select id_deporte, nombre from Deporte";
			ResultSet resultado = conn.ejecutarConsulta(sql);
			while(resultado.next()) {
				listDeportes.add(new Deporte(resultado.getInt("id_deporte"), resultado.getString("nombre")));
			}
			return listDeportes;
		}
		
		public boolean removeDeporte(Deporte d) {
			String sql = "delete from Deporte where id_deporte = ?";
			try {
				ConexionDB conn = new ConexionDB();
				PreparedStatement ps = conn.getPreparedStatement(sql);
				ps.setInt(1, d.getId_deporte());
				ps.executeQuery();
				ps.close();
				conn.cerrarConexion();
			}
			catch(SQLException e) {
				return false;
			}
			return true;
		}
		
		public boolean addDeporte(Deporte d) {
			String sql = "insert into Deporte (id_deporte, nombre) values (?, '?')";
			try {
				ConexionDB conn = new ConexionDB();
				PreparedStatement ps = conn.getPreparedStatement(sql);
				ps.setInt(1, d.getId_deporte());
				ps.setString(2, d.getNombre());
				ps.executeUpdate();
				ps.close();
				conn.cerrarConexion();
			}
			catch(SQLException e) {
				return false;
			}
			return true;
		}
		
		public boolean modifyDeporte(Deporte d) {
			String sql = "update Deporte set nombre = '?' where id_deporte = ?";
			try {
				ConexionDB conn = new ConexionDB();
				PreparedStatement ps = conn.getPreparedStatement(sql);
				ps.setString(1, d.getNombre());
				ps.setInt(2, d.getId_deporte());
				ps.executeQuery();
				ps.close();
				conn.cerrarConexion();
			}
			catch(SQLException e) {
				return false;
			}
			return true;
		}
		
}
